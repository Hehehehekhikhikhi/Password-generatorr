<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🔒 Unlock True Security – Generate Unique Passwords Instantly</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0f0f23;
            --bg-secondary: #1a1a3e;
            --bg-card: #252547;
            --text-primary: #e8e8f3;
            --text-secondary: #a8a8c1;
            --accent-primary: #6366f1;
            --accent-secondary: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --border: #374151;
            --shadow: rgba(99, 102, 241, 0.1);
        }

        [data-theme="light"] {
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-card: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --accent-primary: #6366f1;
            --accent-secondary: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --border: #e2e8f0;
            --shadow: rgba(99, 102, 241, 0.1);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInUp 0.8s ease-out;
        }

        .title {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .tagline {
            font-size: 1.25rem;
            color: var(--text-secondary);
            font-weight: 300;
        }

        .main-card {
            background: var(--bg-card);
            border-radius: 24px;
            padding: 2.5rem;
            box-shadow: 0 25px 50px -12px var(--shadow);
            border: 1px solid var(--border);
            animation: fadeInUp 0.8s ease-out 0.2s both;
            position: relative;
            overflow: hidden;
        }

        .main-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
        }

        .mode-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.75rem;
            margin-bottom: 2rem;
        }

        .mode-button {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .mode-button:hover {
            border-color: var(--accent-primary);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px var(--shadow);
        }

        .mode-button.active {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-color: var(--accent-primary);
            color: white;
        }

        .mode-title {
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 0.25rem;
        }

        .mode-description {
            font-size: 0.8rem;
            color: var(--text-secondary);
            opacity: 0.8;
        }

        .mode-button.active .mode-description {
            color: rgba(255, 255, 255, 0.9);
        }

        .password-section {
            margin-bottom: 2rem;
        }

        .password-display {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            position: relative;
            transition: all 0.3s ease;
        }

        .password-text {
            font-family: 'JetBrains Mono', Consolas, monospace;
            font-size: 1.5rem;
            font-weight: 500;
            word-break: break-all;
            line-height: 1.4;
            min-height: 2.1rem;
            display: flex;
            align-items: center;
        }

        .password-hidden {
            letter-spacing: 0.2rem;
        }

        .strength-meter {
            margin-bottom: 1.5rem;
        }

        .strength-bar {
            height: 8px;
            background: var(--bg-secondary);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.75rem;
        }

        .strength-fill {
            height: 100%;
            transition: all 0.5s ease;
            border-radius: 4px;
        }

        .strength-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
        }

        .controls {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .control-group {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px var(--shadow);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }

        .theme-toggle {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 100;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px var(--shadow);
        }

        .settings {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .setting-group {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: 16px;
            border: 1px solid var(--border);
        }

        .setting-title {
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .slider-group {
            margin-bottom: 1rem;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .slider {
            width: 100%;
            height: 6px;
            background: var(--bg-primary);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: var(--accent-primary);
            border-radius: 50%;
            cursor: pointer;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
        }

        .checkbox {
            width: 18px;
            height: 18px;
            accent-color: var(--accent-primary);
        }

        .tooltip {
            position: absolute;
            background: var(--bg-primary);
            color: var(--text-primary);
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-size: 0.85rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            z-index: 1000;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
            pointer-events: none;
            max-width: 300px;
        }

        .tooltip.show {
            opacity: 1;
            transform: translateY(0);
        }

        .footer {
            text-align: center;
            margin-top: auto;
            padding-top: 3rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .privacy-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--bg-card);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            border: 1px solid var(--border);
            margin-top: 1rem;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .generating {
            animation: pulse 1s infinite;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .main-card {
                padding: 1.5rem;
            }
            
            .controls {
                grid-template-columns: 1fr;
            }
            
            .control-group {
                justify-content: center;
            }
            
            .theme-toggle {
                top: 1rem;
                right: 1rem;
            }
            
            .settings {
                grid-template-columns: 1fr;
            }
        }

        .pattern-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: 'JetBrains Mono', Consolas, monospace;
            margin-bottom: 0.5rem;
        }

        .pattern-help {
            font-size: 0.8rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .breach-check {
            background: var(--bg-secondary);
            padding: 1rem;
            border-radius: 12px;
            border: 1px solid var(--border);
            margin-top: 1rem;
            text-align: center;
        }

        .breach-status {
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .breach-safe {
            color: var(--success);
        }

        .breach-warning {
            color: var(--warning);
        }

        .breach-danger {
            color: var(--danger);
        }
    </style>
</head>
<body data-theme="dark">
    <div class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
        <span id="themeIcon">🌙</span>
    </div>

    <div class="container">
        <header class="header">
            <h1 class="title">🔒 Unlock True Security – Generate Unique Passwords Instantly</h1>
            <p class="tagline">Not your average generator. Premium, private, and truly one-of-a-kind.</p>
        </header>

        <main class="main-card">
            <div class="mode-selector">
                <div class="mode-button active" data-mode="unique">
                    <div class="mode-title">Unique Mode</div>
                    <div class="mode-description">Smart blend of randomness + creativity</div>
                </div>
                <div class="mode-button" data-mode="entropy">
                    <div class="mode-title">Entropy Mode</div>
                    <div class="mode-description">Pure cryptographic randomness</div>
                </div>
                <div class="mode-button" data-mode="passphrase">
                    <div class="mode-title">Passphrase Mode</div>
                    <div class="mode-description">Human-readable, strong passphrases</div>
                </div>
                <div class="mode-button" data-mode="pronounceable">
                    <div class="mode-title">Pronounceable Mode</div>
                    <div class="mode-description">Secure yet easier to recall</div>
                </div>
                <div class="mode-button" data-mode="pattern">
                    <div class="mode-title">Pattern Mode</div>
                    <div class="mode-description">Custom structure, your rules</div>
                </div>
            </div>

            <div class="password-section">
                <div class="password-display">
                    <div class="password-text" id="passwordText">Click Generate to create your secure password</div>
                </div>
                
                <div class="strength-meter">
                    <div class="strength-bar">
                        <div class="strength-fill" id="strengthFill" style="width: 0%; background: var(--danger);"></div>
                    </div>
                    <div class="strength-info">
                        <span id="strengthLabel">Generate a password to see strength</span>
                        <span id="entropyValue">Entropy: 0 bits</span>
                    </div>
                </div>
            </div>

            <div class="controls">
                <div class="control-group">
                    <button class="btn btn-primary" onclick="generatePassword()" id="generateBtn">
                        <span>Generate</span>
                    </button>
                    <button class="btn btn-secondary" onclick="copyPassword()" id="copyBtn" disabled>
                        <span>Copy 🔗</span>
                    </button>
                    <button class="btn btn-secondary" onclick="regeneratePassword()" id="regenBtn" disabled>
                        <span>Regenerate ♻️</span>
                    </button>
                </div>
                <div class="control-group">
                    <button class="btn btn-secondary" onclick="togglePasswordVisibility()" id="visibilityBtn" disabled>
                        <span id="visibilityText">Reveal 👁️</span>
                    </button>
                    <button class="btn btn-secondary" onclick="downloadPassword()" id="downloadBtn" disabled>
                        <span>Download ⬇️</span>
                    </button>
                </div>
            </div>

            <div class="settings" id="settingsContainer">
                <!-- Settings will be dynamically populated based on selected mode -->
            </div>

            <div class="breach-check" id="breachCheck" style="display: none;">
                <div class="breach-status" id="breachStatus"></div>
                <div class="breach-detail" id="breachDetail"></div>
            </div>
        </main>

        <footer class="footer">
            <p>Built with privacy-first principles. Your security, your control.</p>
            <div class="privacy-badge">
                🔐 <span>Client-side only • Zero data collection</span>
            </div>
        </footer>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        // Cryptographically secure random number generator
        class SecureRandom {
            static getRandomValues(array) {
                if (window.crypto && window.crypto.getRandomValues) {
                    return window.crypto.getRandomValues(array);
                } else {
                    // Fallback for older browsers
                    for (let i = 0; i < array.length; i++) {
                        array[i] = Math.floor(Math.random() * 256);
                    }
                    return array;
                }
            }

            static randomInt(min, max) {
                const range = max - min;
                const bytesNeeded = Math.ceil(Math.log2(range) / 8);
                const maxValid = Math.floor(256 ** bytesNeeded / range) * range;
                
                let randomValue;
                do {
                    const randomBytes = new Uint8Array(bytesNeeded);
                    this.getRandomValues(randomBytes);
                    randomValue = randomBytes.reduce((acc, byte, index) => acc + byte * (256 ** index), 0);
                } while (randomValue >= maxValid);
                
                return min + (randomValue % range);
            }

            static choice(array) {
                return array[this.randomInt(0, array.length)];
            }

            static shuffle(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = this.randomInt(0, i + 1);
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            }
        }

        // Password generation engine
        class PasswordGenerator {
            constructor() {
                this.syllables = [
                    'ar', 'ba', 'ce', 'da', 'el', 'fi', 'go', 'ha', 'in', 'jo',
                    'ka', 'la', 'ma', 'no', 'op', 'pa', 'qu', 'ra', 'sa', 'ta',
                    'un', 'va', 'wa', 'xa', 'ya', 'za', 'bel', 'car', 'den', 'fer',
                    'gel', 'har', 'ion', 'jul', 'kor', 'len', 'mor', 'nar', 'ove',
                    'par', 'quin', 'rex', 'son', 'tor', 'ura', 'vel', 'wor', 'xen',
                    'yor', 'zen', 'dra', 'lua', 'nex', 'ora', 'rik', 'tav', 'wyn'
                ];
                
                this.words = [
                    'alpha', 'beta', 'gamma', 'delta', 'theta', 'omega',
                    'crystal', 'ember', 'frost', 'lunar', 'solar', 'storm',
                    'azure', 'crimson', 'golden', 'silver', 'violet', 'emerald',
                    'mystic', 'shadow', 'light', 'dawn', 'dusk', 'twilight',
                    'ocean', 'mountain', 'forest', 'desert', 'glacier', 'volcano',
                    'nova', 'comet', 'meteor', 'galaxy', 'nebula', 'cosmos'
                ];
                
                this.passphraseWords = [
                    'abandon', 'ability', 'able', 'about', 'above', 'absent', 'absorb', 'abstract', 'absurd', 'abuse',
                    'access', 'accident', 'account', 'accuse', 'achieve', 'acid', 'acoustic', 'acquire', 'across', 'act',
                    'action', 'actor', 'actress', 'actual', 'adapt', 'add', 'addict', 'address', 'adjust', 'admit',
                    'adult', 'advance', 'advice', 'aerobic', 'affair', 'afford', 'afraid', 'again', 'against', 'age',
                    'agent', 'agree', 'ahead', 'aim', 'air', 'airport', 'aisle', 'alarm', 'album', 'alcohol',
                    'alert', 'alien', 'all', 'alley', 'allow', 'almost', 'alone', 'alpha', 'already', 'also',
                    'alter', 'always', 'amateur', 'amazing', 'among', 'amount', 'amused', 'analyst', 'anchor', 'ancient',
                    'anger', 'angle', 'angry', 'animal', 'ankle', 'announce', 'annual', 'another', 'answer', 'antenna',
                    'antique', 'anxiety', 'any', 'apart', 'apology', 'appear', 'apple', 'approve', 'april', 'arch',
                    'arctic', 'area', 'arena', 'argue', 'arm', 'armed', 'armor', 'army', 'around', 'arrange'
                ];

                this.currentMode = 'unique';
                this.currentPassword = '';
                this.isPasswordHidden = true;
                this.settings = {
                    unique: { length: 16, includeSymbols: true, includeNumbers: true, syllableCount: 3 },
                    entropy: { length: 16, includeUpper: true, includeLower: true, includeNumbers: true, includeSymbols: true },
                    passphrase: { wordCount: 4, separator: '-', includeNumbers: true, capitalize: true },
                    pronounceable: { length: 12, includeNumbers: true, includeSymbols: true },
                    pattern: { pattern: 'Llll-0000-Ssss', customChars: '' }
                };
            }

            calculateEntropy(password, mode) {
                if (!password) return 0;
                
                let charsetSize = 0;
                const hasLower = /[a-z]/.test(password);
                const hasUpper = /[A-Z]/.test(password);
                const hasNumbers = /[0-9]/.test(password);
                const hasSymbols = /[^a-zA-Z0-9]/.test(password);
                
                if (hasLower) charsetSize += 26;
                if (hasUpper) charsetSize += 26;
                if (hasNumbers) charsetSize += 10;
                if (hasSymbols) charsetSize += 32; // Common symbols
                
                // Adjust for mode-specific entropy
                switch (mode) {
                    case 'passphrase':
                        // Passphrase entropy is calculated differently
                        const words = password.split(/[-\s]/);
                        return words.length * Math.log2(this.passphraseWords.length);
                    case 'pronounceable':
                        // Slightly less entropy due to pronounceable constraints
                        return Math.log2(Math.pow(charsetSize * 0.8, password.length));
                    default:
                        return Math.log2(Math.pow(charsetSize, password.length));
                }
            }

            generateUnique(settings) {
                const { length, includeSymbols, includeNumbers, syllableCount } = settings;
                
                // Build base from syllables
                let base = '';
                for (let i = 0; i < syllableCount; i++) {
                    base += SecureRandom.choice(this.syllables);
                }
                
                // Morphing: capitalize random letters
                base = base.split('').map(char => 
                    SecureRandom.randomInt(0, 100) < 30 ? char.toUpperCase() : char
                ).join('');
                
                // Add numbers
                if (includeNumbers) {
                    const numCount = SecureRandom.randomInt(1, 4);
                    for (let i = 0; i < numCount; i++) {
                        base += SecureRandom.randomInt(0, 10);
                    }
                }
                
                // Add symbols
                if (includeSymbols) {
                    const symbols = '!@#$%^&*-_+=?';
                    const symCount = SecureRandom.randomInt(1, 3);
                    for (let i = 0; i < symCount; i++) {
                        base += SecureRandom.choice(symbols.split(''));
                    }
                }
                
                // Ensure target length by adding random chars or trimming
                const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ' + 
                    (includeNumbers ? '0123456789' : '') + 
                    (includeSymbols ? '!@#$%^&*-_+=?' : '');
                
                while (base.length < length) {
                    base += SecureRandom.choice(charset.split(''));
                }
                
                if (base.length > length) {
                    base = base.substring(0, length);
                }
                
                // Final shuffle to mix syllables with random chars
                return SecureRandom.shuffle(base.split('')).join('');
            }

            generateEntropy(settings) {
                const { length, includeUpper, includeLower, includeNumbers, includeSymbols } = settings;
                
                let charset = '';
                if (includeLower) charset += 'abcdefghijklmnopqrstuvwxyz';
                if (includeUpper) charset += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
                if (includeNumbers) charset += '0123456789';
                if (includeSymbols) charset += '!@#$%^&*()_+-=[]{}|;:,.<>?';
                
                if (!charset) charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
                
                let password = '';
                for (let i = 0; i < length; i++) {
                    password += SecureRandom.choice(charset.split(''));
                }
                
                return password;
            }

            generatePassphrase(settings) {
                const { wordCount, separator, includeNumbers, capitalize } = settings;
                
                let words = [];
                for (let i = 0; i < wordCount; i++) {
                    let word = SecureRandom.choice(this.passphraseWords);
                    if (capitalize && SecureRandom.randomInt(0, 100) < 70) {
                        word = word.charAt(0).toUpperCase() + word.slice(1);
                    }
                    words.push(word);
                }
                
                let passphrase = words.join(separator);
                
                if (includeNumbers) {
                    passphrase += SecureRandom.randomInt(1, 100);
                }
                
                return passphrase;
            }

            generatePronounceable(settings) {
                const { length, includeNumbers, includeSymbols } = settings;
                
                let password = '';
                const targetSyllables = Math.ceil(length / 3);
                
                for (let i = 0; i < targetSyllables && password.length < length - 3; i++) {
                    let syllable = SecureRandom.choice(this.syllables);
                    
                    // Capitalize some syllables
                    if (i === 0 || SecureRandom.randomInt(0, 100) < 20) {
                        syllable = syllable.charAt(0).toUpperCase() + syllable.slice(1);
                    }
                    
                    password += syllable;
                }
                
                // Add numbers
                if (includeNumbers && password.length < length - 2) {
                    password += SecureRandom.randomInt(1, 99);
                }
                
                // Add a symbol
                if (includeSymbols && password.length < length - 1) {
                    const symbols = '!@#$%*-_+?';
                    password += SecureRandom.choice(symbols.split(''));
                }
                
                return password.substring(0, length);
            }

            generatePattern(settings) {
                const { pattern } = settings;
                let result = '';
                
                for (let char of pattern) {
                    switch (char) {
                        case 'L': // Uppercase letter
                            result += SecureRandom.choice('ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split(''));
                            break;
                        case 'l': // Lowercase letter
                            result += SecureRandom.choice('abcdefghijklmnopqrstuvwxyz'.split(''));
                            break;
                        case '0': // Number
                            result += SecureRandom.choice('0123456789'.split(''));
                            break;
                        case 'S': // Symbol
                            result += SecureRandom.choice('!@#$%^&*()_+-=[]{}|;:,.<>?'.split(''));
                            break;
                        case 's': // Safe symbol
                            result += SecureRandom.choice('!@#$%^&*-_+=?'.split(''));
                            break;
                        case 'A': // Any alphanumeric
                            result += SecureRandom.choice('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'.split(''));
                            break;
                        default:
                            result += char; // Literal character
                    }
                }
                
                return result;
            }

            generate(mode = this.currentMode) {
                const settings = this.settings[mode];
                let password = '';
                
                switch (mode) {
                    case 'unique':
                        password = this.generateUnique(settings);
                        break;
                    case 'entropy':
                        password = this.generateEntropy(settings);
                        break;
                    case 'passphrase':
                        password = this.generatePassphrase(settings);
                        break;
                    case 'pronounceable':
                        password = this.generatePronounceable(settings);
                        break;
                    case 'pattern':
                        password = this.generatePattern(settings);
                        break;
                    default:
                        password = this.generateUnique(this.settings.unique);
                }
                
                this.currentPassword = password;
                return password;
            }
        }

        // Password strength analyzer
        class StrengthAnalyzer {
            static analyze(password, mode) {
                if (!password) return { score: 0, label: 'Generate a password to see strength', entropy: 0 };
                
                const entropy = new PasswordGenerator().calculateEntropy(password, mode);
                let score = 0;
                let label = '';
                let color = '';
                
                // Basic scoring based on entropy
                if (entropy < 30) {
                    score = 25;
                    label = '⚠️ Easily guessable';
                    color = 'var(--danger)';
                } else if (entropy < 50) {
                    score = 50;
                    label = '🟡 Decent, but could be stronger';
                    color = 'var(--warning)';
                } else if (entropy < 70) {
                    score = 75;
                    label = '🟢 Good security';
                    color = 'var(--success)';
                } else {
                    score = 100;
                    label = '🟣 Practically unbreakable';
                    color = 'var(--accent-primary)';
                }
                
                // Bonus points for various characteristics
                const bonuses = {
                    length: Math.min(password.length * 2, 20),
                    uppercase: /[A-Z]/.test(password) ? 5 : 0,
                    lowercase: /[a-z]/.test(password) ? 5 : 0,
                    numbers: /[0-9]/.test(password) ? 5 : 0,
                    symbols: /[^a-zA-Z0-9]/.test(password) ? 10 : 0,
                    noRepeat: !/(.).*\1/.test(password) ? 5 : 0, // No repeated characters
                    noSequence: !/(?:abc|bcd|cde|def|123|234|345|456|567|678|789|890)/i.test(password) ? 5 : 0
                };
                
                const bonusScore = Object.values(bonuses).reduce((sum, bonus) => sum + bonus, 0);
                score = Math.min(100, score + bonusScore * 0.3);
                
                return { score, label, color, entropy: Math.round(entropy) };
            }
        }

        // Breach checker using k-anonymity (simulated)
        class BreachChecker {
            static async checkPassword(password) {
                // Simulate API call delay
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Simple simulation - in real implementation, this would use HaveIBeenPwned API
                // with k-anonymity (only first 5 chars of SHA-1 hash sent)
                const commonPasswords = [
                    'password', '123456', '123456789', 'qwerty', 'abc123', 'password123',
                    'admin', 'letmein', 'welcome', 'monkey', 'dragon', 'master'
                ];
                
                const isCommon = commonPasswords.some(common => 
                    password.toLowerCase().includes(common.toLowerCase()) || 
                    common.toLowerCase().includes(password.toLowerCase())
                );
                
                // Simulate different breach scenarios
                const random = Math.random();
                if (isCommon) {
                    return {
                        safe: false,
                        severity: 'high',
                        message: 'This password appears in known data breaches',
                        count: Math.floor(Math.random() * 10000) + 1000
                    };
                } else if (random < 0.05) {
                    return {
                        safe: false,
                        severity: 'medium',
                        message: 'Similar passwords found in breaches',
                        count: Math.floor(Math.random() * 100) + 10
                    };
                } else {
                    return {
                        safe: true,
                        severity: 'none',
                        message: 'No breaches found for this password',
                        count: 0
                    };
                }
            }
        }

        // Application state and UI management
        class PasswordApp {
            constructor() {
                this.generator = new PasswordGenerator();
                this.currentMode = 'unique';
                this.isPasswordVisible = false;
                this.tooltipTimeout = null;
                
                this.initializeEventListeners();
                this.setupModeSettings();
                this.showTooltip();
            }

            initializeEventListeners() {
                // Mode selection
                document.querySelectorAll('.mode-button').forEach(button => {
                    button.addEventListener('click', () => {
                        this.selectMode(button.dataset.mode);
                    });
                });

                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey || e.metaKey) {
                        if (e.key === 'Enter') {
                            e.preventDefault();
                            this.generatePassword();
                        } else if (e.key === 'c' && this.generator.currentPassword) {
                            e.preventDefault();
                            this.copyPassword();
                        }
                    } else if (e.key === 'F5' && this.generator.currentPassword) {
                        e.preventDefault();
                        this.regeneratePassword();
                    }
                });
            }

            selectMode(mode) {
                this.currentMode = mode;
                this.generator.currentMode = mode;
                
                // Update UI
                document.querySelectorAll('.mode-button').forEach(btn => btn.classList.remove('active'));
                document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
                
                this.setupModeSettings();
                
                // Clear previous password
                this.clearPassword();
            }

            setupModeSettings() {
                const container = document.getElementById('settingsContainer');
                const settings = this.generator.settings[this.currentMode];
                
                container.innerHTML = '';
                
                switch (this.currentMode) {
                    case 'unique':
                        container.innerHTML = `
                            <div class="setting-group">
                                <div class="setting-title">Unique Settings</div>
                                <div class="slider-group">
                                    <div class="slider-label">
                                        <span>Length</span>
                                        <span id="lengthValue">${settings.length}</span>
                                    </div>
                                    <input type="range" class="slider" min="8" max="64" value="${settings.length}" 
                                           onInput="app.updateSetting('length', this.value)">
                                </div>
                                <div class="slider-group">
                                    <div class="slider-label">
                                        <span>Syllables</span>
                                        <span id="syllableValue">${settings.syllableCount}</span>
                                    </div>
                                    <input type="range" class="slider" min="1" max="8" value="${settings.syllableCount}" 
                                           onInput="app.updateSetting('syllableCount', this.value)">
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" class="checkbox" ${settings.includeNumbers ? 'checked' : ''} 
                                           onChange="app.updateSetting('includeNumbers', this.checked)">
                                    <label>Include Numbers</label>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" class="checkbox" ${settings.includeSymbols ? 'checked' : ''} 
                                           onChange="app.updateSetting('includeSymbols', this.checked)">
                                    <label>Include Symbols</label>
                                </div>
                            </div>
                        `;
                        break;
                        
                    case 'entropy':
                        container.innerHTML = `
                            <div class="setting-group">
                                <div class="setting-title">Entropy Settings</div>
                                <div class="slider-group">
                                    <div class="slider-label">
                                        <span>Length</span>
                                        <span id="lengthValue">${settings.length}</span>
                                    </div>
                                    <input type="range" class="slider" min="8" max="128" value="${settings.length}" 
                                           onInput="app.updateSetting('length', this.value)">
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" class="checkbox" ${settings.includeUpper ? 'checked' : ''} 
                                           onChange="app.updateSetting('includeUpper', this.checked)">
                                    <label>Uppercase Letters (A-Z)</label>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" class="checkbox" ${settings.includeLower ? 'checked' : ''} 
                                           onChange="app.updateSetting('includeLower', this.checked)">
                                    <label>Lowercase Letters (a-z)</label>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" class="checkbox" ${settings.includeNumbers ? 'checked' : ''} 
                                           onChange="app.updateSetting('includeNumbers', this.checked)">
                                    <label>Numbers (0-9)</label>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" class="checkbox" ${settings.includeSymbols ? 'checked' : ''} 
                                           onChange="app.updateSetting('includeSymbols', this.checked)">
                                    <label>Symbols (!@#$%^&*)</label>
                                </div>
                            </div>
                        `;
                        break;
                        
                    case 'passphrase':
                        container.innerHTML = `
                            <div class="setting-group">
                                <div class="setting-title">Passphrase Settings</div>
                                <div class="slider-group">
                                    <div class="slider-label">
                                        <span>Word Count</span>
                                        <span id="wordCountValue">${settings.wordCount}</span>
                                    </div>
                                    <input type="range" class="slider" min="2" max="12" value="${settings.wordCount}" 
                                           onInput="app.updateSetting('wordCount', this.value)">
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" class="checkbox" ${settings.includeNumbers ? 'checked' : ''} 
                                           onChange="app.updateSetting('includeNumbers', this.checked)">
                                    <label>Include Numbers</label>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" class="checkbox" ${settings.capitalize ? 'checked' : ''} 
                                           onChange="app.updateSetting('capitalize', this.checked)">
                                    <label>Capitalize Words</label>
                                </div>
                            </div>
                        `;
                        break;
                        
                    case 'pronounceable':
                        container.innerHTML = `
                            <div class="setting-group">
                                <div class="setting-title">Pronounceable Settings</div>
                                <div class="slider-group">
                                    <div class="slider-label">
                                        <span>Length</span>
                                        <span id="lengthValue">${settings.length}</span>
                                    </div>
                                    <input type="range" class="slider" min="6" max="32" value="${settings.length}" 
                                           onInput="app.updateSetting('length', this.value)">
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" class="checkbox" ${settings.includeNumbers ? 'checked' : ''} 
                                           onChange="app.updateSetting('includeNumbers', this.checked)">
                                    <label>Include Numbers</label>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" class="checkbox" ${settings.includeSymbols ? 'checked' : ''} 
                                           onChange="app.updateSetting('includeSymbols', this.checked)">
                                    <label>Include Symbols</label>
                                </div>
                            </div>
                        `;
                        break;
                        
                    case 'pattern':
                        container.innerHTML = `
                            <div class="setting-group">
                                <div class="setting-title">Pattern Settings</div>
                                <input type="text" class="pattern-input" value="${settings.pattern}" 
                                       onInput="app.updateSetting('pattern', this.value)" 
                                       placeholder="Enter pattern (e.g., Llll-0000-Ssss)">
                                <div class="pattern-help">
                                    Pattern codes:<br>
                                    <strong>L</strong> = Uppercase letter • <strong>l</strong> = Lowercase letter<br>
                                    <strong>0</strong> = Number • <strong>S</strong> = Any symbol<br>
                                    <strong>s</strong> = Safe symbol • <strong>A</strong> = Alphanumeric<br>
                                    Any other character will be used literally
                                </div>
                            </div>
                        `;
                        break;
                }
            }

            updateSetting(key, value) {
                if (key === 'length' || key === 'wordCount' || key === 'syllableCount') {
                    this.generator.settings[this.currentMode][key] = parseInt(value);
                    document.getElementById(key + 'Value').textContent = value;
                } else {
                    this.generator.settings[this.currentMode][key] = value;
                }
            }

            generatePassword() {
                const generateBtn = document.getElementById('generateBtn');
                generateBtn.classList.add('generating');
                generateBtn.disabled = true;
                
                setTimeout(() => {
                    const password = this.generator.generate();
                    this.displayPassword(password);
                    this.updateStrengthMeter(password);
                    this.enableControls();
                    this.checkPasswordBreach(password);
                    
                    generateBtn.classList.remove('generating');
                    generateBtn.disabled = false;
                    
                    this.isPasswordVisible = false;
                    document.getElementById('visibilityText').textContent = 'Reveal 👁️';
                }, 300);
            }

            regeneratePassword() {
                if (this.generator.currentPassword) {
                    this.generatePassword();
                }
            }

            displayPassword(password) {
                const passwordText = document.getElementById('passwordText');
                passwordText.textContent = this.isPasswordVisible ? password : '•'.repeat(password.length);
                passwordText.classList.toggle('password-hidden', !this.isPasswordVisible);
            }

            updateStrengthMeter(password) {
                const strength = StrengthAnalyzer.analyze(password, this.currentMode);
                
                document.getElementById('strengthFill').style.width = strength.score + '%';
                document.getElementById('strengthFill').style.background = strength.color;
                document.getElementById('strengthLabel').textContent = strength.label;
                document.getElementById('entropyValue').textContent = `Entropy: ${strength.entropy} bits`;
            }

            togglePasswordVisibility() {
                if (!this.generator.currentPassword) return;
                
                this.isPasswordVisible = !this.isPasswordVisible;
                this.displayPassword(this.generator.currentPassword);
                
                const visibilityBtn = document.getElementById('visibilityText');
                visibilityBtn.textContent = this.isPasswordVisible ? 'Hide 🙈' : 'Reveal 👁️';
            }

            async copyPassword() {
                if (!this.generator.currentPassword) return;
                
                try {
                    await navigator.clipboard.writeText(this.generator.currentPassword);
                    this.showTemporaryMessage('Password copied to clipboard! 📋', 'success');
                } catch (err) {
                    // Fallback for older browsers
                    const textArea = document.createElement('textarea');
                    textArea.value = this.generator.currentPassword;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    this.showTemporaryMessage('Password copied to clipboard! 📋', 'success');
                }
            }

            downloadPassword() {
                if (!this.generator.currentPassword) return;
                
                const timestamp = new Date().toISOString().split('T')[0];
                const content = `Generated Password - ${timestamp}\n\nPassword: ${this.generator.currentPassword}\nMode: ${this.currentMode.charAt(0).toUpperCase() + this.currentMode.slice(1)}\nGenerated: ${new Date().toLocaleString()}\n\n⚠️ Security Notice:\n• Store this file securely\n• Delete after use if not needed\n• Do not share via insecure channels`;
                
                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `secure-password-${timestamp}.txt`;
                a.click();
                URL.revokeObjectURL(url);
                
                this.showTemporaryMessage('Password downloaded securely! 📥', 'success');
            }

            async checkPasswordBreach(password) {
                const breachCheck = document.getElementById('breachCheck');
                const breachStatus = document.getElementById('breachStatus');
                const breachDetail = document.getElementById('breachDetail');
                
                breachCheck.style.display = 'block';
                breachStatus.textContent = 'Checking against known breaches...';
                breachStatus.className = 'breach-status';
                breachDetail.textContent = '';
                
                try {
                    const result = await BreachChecker.checkPassword(password);
                    
                    if (result.safe) {
                        breachStatus.textContent = '✅ Password appears safe';
                        breachStatus.className = 'breach-status breach-safe';
                        breachDetail.textContent = result.message;
                    } else {
                        breachStatus.textContent = result.severity === 'high' ? '⚠️ Security Risk Detected' : '⚡ Potential Risk';
                        breachStatus.className = `breach-status ${result.severity === 'high' ? 'breach-danger' : 'breach-warning'}`;
                        breachDetail.textContent = `${result.message} (${result.count.toLocaleString()} occurrences)`;
                    }
                } catch (error) {
                    breachStatus.textContent = '❓ Unable to check breaches';
                    breachStatus.className = 'breach-status';
                    breachDetail.textContent = 'Breach check service unavailable';
                }
            }

            enableControls() {
                const controls = ['copyBtn', 'regenBtn', 'visibilityBtn', 'downloadBtn'];
                controls.forEach(id => {
                    document.getElementById(id).disabled = false;
                });
            }

            clearPassword() {
                this.generator.currentPassword = '';
                document.getElementById('passwordText').textContent = 'Click Generate to create your secure password';
                document.getElementById('strengthFill').style.width = '0%';
                document.getElementById('strengthLabel').textContent = 'Generate a password to see strength';
                document.getElementById('entropyValue').textContent = 'Entropy: 0 bits';
                document.getElementById('breachCheck').style.display = 'none';
                
                const controls = ['copyBtn', 'regenBtn', 'visibilityBtn', 'downloadBtn'];
                controls.forEach(id => {
                    document.getElementById(id).disabled = true;
                });
            }

            showTemporaryMessage(message, type) {
                const toast = document.createElement('div');
                toast.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: var(--accent-primary);
                    color: white;
                    padding: 1rem 1.5rem;
                    border-radius: 12px;
                    font-weight: 500;
                    z-index: 1000;
                    animation: slideInRight 0.3s ease;
                    box-shadow: 0 10px 25px var(--shadow);
                `;
                toast.textContent = message;
                document.body.appendChild(toast);
                
                setTimeout(() => {
                    toast.style.animation = 'slideOutRight 0.3s ease forwards';
                    setTimeout(() => document.body.removeChild(toast), 300);
                }, 3000);
            }

            showTooltip() {
                if (localStorage.getItem('passwordGeneratorTooltipSeen')) return;
                
                setTimeout(() => {
                    const tooltip = document.getElementById('tooltip');
                    const generateBtn = document.getElementById('generateBtn');
                    const rect = generateBtn.getBoundingClientRect();
                    
                    tooltip.textContent = 'Your passwords are generated securely inside your browser. Nothing is ever sent or stored.';
                    tooltip.style.left = rect.left + 'px';
                    tooltip.style.top = (rect.bottom + 10) + 'px';
                    tooltip.classList.add('show');
                    
                    setTimeout(() => {
                        tooltip.classList.remove('show');
                        localStorage.setItem('passwordGeneratorTooltipSeen', 'true');
                    }, 5000);
                }, 1000);
            }
        }

        // Theme management
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            document.getElementById('themeIcon').textContent = newTheme === 'dark' ? '🌙' : '☀️';
            
            localStorage.setItem('preferred-theme', newTheme);
        }

        // Global functions for inline event handlers
        function generatePassword() {
            app.generatePassword();
        }

        function copyPassword() {
            app.copyPassword();
        }

        function regeneratePassword() {
            app.regeneratePassword();
        }

        function togglePasswordVisibility() {
            app.togglePasswordVisibility();
        }

        function downloadPassword() {
            app.downloadPassword();
        }

        // Initialize application
        let app;
        document.addEventListener('DOMContentLoaded', () => {
            // Load saved theme preference
            const savedTheme = localStorage.getItem('preferred-theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.getElementById('themeIcon').textContent = savedTheme === 'dark' ? '🌙' : '☀️';
            
            // Initialize app
            app = new PasswordApp();
        });

        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
